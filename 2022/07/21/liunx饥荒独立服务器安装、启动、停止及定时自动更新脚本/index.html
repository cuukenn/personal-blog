<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>cuukenn的个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="liunx饥荒独立服务器安装、启动、停止及定时自动更新脚本注：  部分基础内容摘自：https:&#x2F;&#x2F;blog.csdn.net&#x2F;szhiy&#x2F;article&#x2F;details&#x2F;79996017 增加内容：定时更新、安装及启停脚本 脚本下载地址：https:&#x2F;&#x2F;github.com&#x2F;cuukenn&#x2F;dontstarveserver 小内存机器无法同时启动地上、地下服务器：增加swap分区https:&#x2F;&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="cuukenn的个人博客">
<meta property="og:url" content="https://cuukenn.github.io/2022/07/21/liunx%E9%A5%A5%E8%8D%92%E7%8B%AC%E7%AB%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85%E3%80%81%E5%90%AF%E5%8A%A8%E3%80%81%E5%81%9C%E6%AD%A2%E5%8F%8A%E5%AE%9A%E6%97%B6%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E8%84%9A%E6%9C%AC/index.html">
<meta property="og:site_name" content="cuukenn的个人博客">
<meta property="og:description" content="liunx饥荒独立服务器安装、启动、停止及定时自动更新脚本注：  部分基础内容摘自：https:&#x2F;&#x2F;blog.csdn.net&#x2F;szhiy&#x2F;article&#x2F;details&#x2F;79996017 增加内容：定时更新、安装及启停脚本 脚本下载地址：https:&#x2F;&#x2F;github.com&#x2F;cuukenn&#x2F;dontstarveserver 小内存机器无法同时启动地上、地下服务器：增加swap分区https:&#x2F;&#x2F;">
<meta property="og:locale">
<meta property="article:published_time" content="2022-07-21T12:52:10.578Z">
<meta property="article:modified_time" content="2022-07-21T12:52:10.578Z">
<meta property="article:author" content="changgg">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="cuukenn的个人博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">cuukenn的个人博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://cuukenn.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-liunx饥荒独立服务器安装、启动、停止及定时自动更新脚本" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/21/liunx%E9%A5%A5%E8%8D%92%E7%8B%AC%E7%AB%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85%E3%80%81%E5%90%AF%E5%8A%A8%E3%80%81%E5%81%9C%E6%AD%A2%E5%8F%8A%E5%AE%9A%E6%97%B6%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E8%84%9A%E6%9C%AC/" class="article-date">
  <time class="dt-published" datetime="2022-07-21T12:52:10.578Z" itemprop="datePublished">2022-07-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="liunx饥荒独立服务器安装、启动、停止及定时自动更新脚本"><a href="#liunx饥荒独立服务器安装、启动、停止及定时自动更新脚本" class="headerlink" title="liunx饥荒独立服务器安装、启动、停止及定时自动更新脚本"></a>liunx饥荒独立服务器安装、启动、停止及定时自动更新脚本</h1><p>注：</p>
<ul>
<li>部分基础内容摘自：<a target="_blank" rel="noopener" href="https://blog.csdn.net/szhiy/article/details/79996017">https://blog.csdn.net/szhiy/article/details/79996017</a></li>
<li>增加内容：定时更新、安装及启停脚本</li>
<li>脚本下载地址：<a target="_blank" rel="noopener" href="https://github.com/love390/dontstarveserver">https://github.com/cuukenn/dontstarveserver</a></li>
<li>小内存机器无法同时启动地上、地下服务器：增加swap分区<a target="_blank" rel="noopener" href="https://www.cnblogs.com/chentop/p/10330052.html">https://www.cnblogs.com/chentop/p/10330052.html</a></li>
</ul>
<h3 id="一、解决环境依赖"><a href="#一、解决环境依赖" class="headerlink" title="一、解决环境依赖"></a>一、解决环境依赖</h3><ul>
<li>Ubuntu 系统需要的依赖：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libstdc++6:i386 libgcc1:i386 libcurl4-gnutls-dev:i386 lib32gcc1</span><br></pre></td></tr></table></figure></li>
<li>CentOS 系统需要的依赖 (仅供参考)：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install glibc.i686 libstdc++.i686 libcurl4-gnutls-dev.i686 libcurl.i686</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="二，创建专用用户"><a href="#二，创建专用用户" class="headerlink" title="二，创建专用用户"></a>二，创建专用用户</h3> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">useradd steam</span><br><span class="line">password steam</span><br><span class="line">su steam</span><br></pre></td></tr></table></figure>
<p> 注：相关脚本涉及根路径为&#x2F;home&#x2F;steam,不创建特定用户修改对应脚本路径也没问题</p>
<h3 id="二、安装-SteamCMD"><a href="#二、安装-SteamCMD" class="headerlink" title="二、安装 SteamCMD"></a>二、安装 SteamCMD</h3><ul>
<li>此目录用于 steam 程序的安装目录。<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/steamcmd</span><br></pre></td></tr></table></figure></li>
<li>下载 SteamCMD 安装文件<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -P ~/steamcmd https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz</span><br></pre></td></tr></table></figure></li>
<li>解压压缩包<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/steamcmd</span><br><span class="line">tar -xvzf ~/steamcmd/steamcmd_linux.tar.gz</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="三、安装饥荒服务端"><a href="#三、安装饥荒服务端" class="headerlink" title="三、安装饥荒服务端"></a>三、安装饥荒服务端</h3><ul>
<li>准备好相关文件(暂时放到&#x2F;home&#x2F;steam目录)<ul>
<li>cron_update_starve.sh：用于cron定时调度完成服务器更新的脚本</li>
<li>update_starve.cmd：steamcmd运行时实际命令</li>
<li>update_starve.sh：用于下载饥荒服务器至指定目录</li>
<li>start.sh：在后台启动地上地上服务器</li>
<li>start_master.sh：前台启动地上服务器</li>
<li>start_cave.sh：前台启动地下服务器</li>
<li>stop.sh：停止所有服务器</li>
</ul>
</li>
<li>赋予执行权限<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- chmod u+x *.sh</span><br></pre></td></tr></table></figure></li>
<li>启动安装脚本<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./update_starve.sh</span><br></pre></td></tr></table></figure></li>
<li>移动启停脚本<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mv start* /home/steam/common/dstserver/bin</span><br><span class="line">mv stop*  /home/steam/common/dstserver/bin</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="四，准备游戏存档及mods"><a href="#四，准备游戏存档及mods" class="headerlink" title="四，准备游戏存档及mods"></a>四，准备游戏存档及mods</h3><ul>
<li>复制相关mods至&#x2F;home&#x2F;steam&#x2F;common&#x2F;dstserver&#x2F;mods</li>
<li>复制存档至&#x2F;home&#x2F;steam&#x2F;.Klei\DoNotStarveTogether\Cluster_1</li>
</ul>
<h3 id="五，解决一个-lib-缺失"><a href="#五，解决一个-lib-缺失" class="headerlink" title="五，解决一个 lib 缺失"></a>五，解决一个 lib 缺失</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /home/steam/common/dstserver/bin/lib32</span><br><span class="line">ln -s /usr/lib/libcurl.so.4 libcurl-gnutls.so.4</span><br></pre></td></tr></table></figure>

<h3 id="六，设置定时调度"><a href="#六，设置定时调度" class="headerlink" title="六，设置定时调度"></a>六，设置定时调度</h3><ul>
<li>centos<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable crond</span><br><span class="line">systemctl start  crond</span><br></pre></td></tr></table></figure>
使用crontab -e后写入：0 3 * *  * &#x2F;home&#x2F;steam&#x2F;cron_update_starve.sh，保存<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="七、预期文件目录结构（仅保留核心内容）"><a href="#七、预期文件目录结构（仅保留核心内容）" class="headerlink" title="七、预期文件目录结构（仅保留核心内容）"></a>七、预期文件目录结构（仅保留核心内容）</h3><p>│&#x2F;steam<br>├──common<br>│   └── dstserver<br>│       ├── bin<br>│       │   ├── start_cave.sh<br>│       │   ├── start_master.sh<br>│       │   ├── start.sh<br>│       │   ├── steam_appid.txt<br>│       │   └── stop.sh<br>├── steamcmd<br>│   └── steamcmd.sh<br>├── update_starve.cmd<br>└── update_starve.sh<br>├── cron_update_starve.sh</p>
<h3 id="八、启动及验证"><a href="#八、启动及验证" class="headerlink" title="八、启动及验证"></a>八、启动及验证</h3><ul>
<li>启动<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/steam/common/dstserver/bin/start.sh</span><br></pre></td></tr></table></figure></li>
<li>验证<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep donts</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://cuukenn.github.io/2022/07/21/liunx%E9%A5%A5%E8%8D%92%E7%8B%AC%E7%AB%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85%E3%80%81%E5%90%AF%E5%8A%A8%E3%80%81%E5%81%9C%E6%AD%A2%E5%8F%8A%E5%AE%9A%E6%97%B6%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E8%84%9A%E6%9C%AC/" data-id="cl5v1sztl0000gg0o8bsn66hl" data-title="" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
    
  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/07/21/liunx%E9%A5%A5%E8%8D%92%E7%8B%AC%E7%AB%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85%E3%80%81%E5%90%AF%E5%8A%A8%E3%80%81%E5%81%9C%E6%AD%A2%E5%8F%8A%E5%AE%9A%E6%97%B6%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E8%84%9A%E6%9C%AC/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 changgg<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>